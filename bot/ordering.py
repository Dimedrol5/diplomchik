from telegram import ReplyKeyboardMarkup
import random
from bot.keyboards import get_html_practice_menu, get_java_practice_menu, get_python_practice_menu, get_main_menu, get_ordering_task_menu
from bot.states import get_user_state

# –°–ø–∏—Å–æ–∫ –∑–∞–≤–¥–∞–Ω—å –Ω–∞ –ø–æ—Ä—è–¥–æ–∫ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö –º–æ–≤
RAW_ORDERING_TASKS = {
    "HTML/CSS/JS": [
    {
        "steps": [
            "–í—ñ–¥–∫—Ä–∏—Ç–∏ —Ç–µ–≥ html",
            "–í—Å—Ç–∞–≤–∏—Ç–∏ —Ç–µ–≥ head",
            "–î–æ–¥–∞—Ç–∏ —Ç–µ–≥ body"
        ],
        "correct_order": "1-2-3",
        "title": "üìù –£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –∫—Ä–æ–∫–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è HTML-—Å—Ç–æ—Ä—ñ–Ω–∫–∏:"
    },
    {
        "steps": [
            "–ü—ñ–¥–∫–ª—é—á–∏—Ç–∏ –∑–æ–≤–Ω—ñ—à–Ω—ñ–π CSS —Ñ–∞–π–ª",
            "–ù–∞–ø–∏—Å–∞—Ç–∏ —Å—Ç–∏–ª—ñ –≤ CSS —Ñ–∞–π–ª—ñ",
            "–û–Ω–æ–≤–∏—Ç–∏ HTML —Å—Ç–æ—Ä—ñ–Ω–∫—É –≤ –±—Ä–∞—É–∑–µ—Ä—ñ"
        ],
        "correct_order": "1-2-3",
        "title": "üé® –£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –∫—Ä–æ–∫–∏ –¥–ª—è –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è —Å—Ç–∏–ª—ñ–≤ CSS:"
    },
    {
        "steps": [
            "–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥ <a>",
            "–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∞—Ç—Ä–∏–±—É—Ç href",
            "–í—Å—Ç–∞–≤–∏—Ç–∏ —Ç–µ–∫—Å—Ç –ø–æ—Å–∏–ª–∞–Ω–Ω—è"
        ],
        "correct_order": "1-2-3",
        "title": "üîó –£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –∫—Ä–æ–∫–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –≥—ñ–ø–µ—Ä–ø–æ—Å–∏–ª–∞–Ω–Ω—è –≤ HTML:"
    },
    {
        "steps": [
            "–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥ <script>",
            "–ù–∞–ø–∏—Å–∞—Ç–∏ JavaScript –∫–æ–¥",
            "–í—Å—Ç–∞–≤–∏—Ç–∏ —Ç–µ–≥ —É HTML-–¥–æ–∫—É–º–µ–Ω—Ç"
        ],
        "correct_order": "1-2-3",
        "title": "üõ†Ô∏è –£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –∫—Ä–æ–∫–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è JavaScript –¥–æ HTML:"
    },
    {
        "steps": [
            "–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥ <img>",
            "–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∞—Ç—Ä–∏–±—É—Ç src",
            "–î–æ–¥–∞—Ç–∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∏–π —Ç–µ–∫—Å—Ç (alt)"
        ],
        "correct_order": "1-2-3",
        "title": "üñºÔ∏è –£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –∫—Ä–æ–∫–∏ –≤—Å—Ç–∞–≤–∫–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤ HTML:"
    },
    {
        "steps": [
            "–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥ <form>",
            "–î–æ–¥–∞—Ç–∏ –ø–æ–ª—è –≤–≤–µ–¥–µ–Ω–Ω—è (input)",
            "–î–æ–¥–∞—Ç–∏ –∫–Ω–æ–ø–∫—É –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ (submit)"
        ],
        "correct_order": "1-2-3",
        "title": "üì® –£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –∫—Ä–æ–∫–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ñ–æ—Ä–º–∏ –≤ HTML:"
    },
    {
        "steps": [
            "–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥ <table>",
            "–î–æ–¥–∞—Ç–∏ —Ä—è–¥–∫–∏ —Ç–∞–±–ª–∏—Ü—ñ (tr)",
            "–î–æ–¥–∞—Ç–∏ –∫–æ–º—ñ—Ä–∫–∏ —Ç–∞–±–ª–∏—Ü—ñ (td)"
        ],
        "correct_order": "1-2-3",
        "title": "üìã –£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –∫—Ä–æ–∫–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ –≤ HTML:"
    },
    {
        "steps": [
            "–ù–∞–ø–∏—Å–∞—Ç–∏ CSS —Å–µ–ª–µ–∫—Ç–æ—Ä",
            "–í–∏–∑–Ω–∞—á–∏—Ç–∏ –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å (property)",
            "–ó–∞–¥–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ (value)"
        ],
        "correct_order": "1-2-3",
        "title": "üé® –£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –∫—Ä–æ–∫–∏ –Ω–∞–ø–∏—Å–∞–Ω–Ω—è CSS-–ø—Ä–∞–≤–∏–ª–∞:"
    },
    {
        "steps": [
            "–ù–∞–ø–∏—Å–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é JavaScript",
            "–í–∏–∫–ª–∏–∫–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é –∑ –ø–æ–¥—ñ—ó (onclick)",
            "–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É –±—Ä–∞—É–∑–µ—Ä—ñ"
        ],
        "correct_order": "1-2-3",
        "title": "üñ±Ô∏è –£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –∫—Ä–æ–∫–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –æ–±—Ä–æ–±–Ω–∏–∫–∞ –ø–æ–¥—ñ–π –≤ JavaScript:"
    },
    {
        "steps": [
            "–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥ <ul>",
            "–î–æ–¥–∞—Ç–∏ –µ–ª–µ–º–µ–Ω—Ç–∏ —Å–ø–∏—Å–∫—É (li)",
            "–í—ñ–¥–æ–±—Ä–∞–∑–∏—Ç–∏ —Å–ø–∏—Å–æ–∫ —É –±—Ä–∞—É–∑–µ—Ä—ñ"
        ],
        "correct_order": "1-2-3",
        "title": "üìë –£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –∫—Ä–æ–∫–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–∞—Ä–∫–æ–≤–∞–Ω–æ–≥–æ —Å–ø–∏—Å–∫—É –≤ HTML:"
    }
],
    "Python": [
    {
        "steps": [
            "–ù–∞–ø–∏—Å–∞—Ç–∏ –∫–æ–¥ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: print('Hello'))",
            "–ó–±–µ—Ä–µ–≥—Ç–∏ —Ñ–∞–π–ª –∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è–º .py",
            "–ó–∞–ø—É—Å—Ç–∏—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º—É —á–µ—Ä–µ–∑ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä Python"
        ],
        "correct_order": "1-2-3",
        "title": "üêç –£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –∫—Ä–æ–∫–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—Ä–æ—Å—Ç–æ—ó –ø—Ä–æ–≥—Ä–∞–º–∏ Python:"
    },
    {
        "steps": [
            "–Ü–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –º–æ–¥—É–ª—å (import math)",
            "–í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é –º–æ–¥—É–ª—è (math.sqrt())",
            "–ó–∞–ø—É—Å—Ç–∏—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º—É"
        ],
        "correct_order": "1-2-3",
        "title": "üßÆ –£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –∫—Ä–æ–∫–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –º–æ–¥—É–ª—è –≤ Python:"
    },
    {
        "steps": [
            "–û–≥–æ–ª–æ—Å–∏—Ç–∏ –∑–º—ñ–Ω–Ω—É",
            "–ü—Ä–∏—Å–≤–æ—ó—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–º—ñ–Ω–Ω—ñ–π",
            "–í–∏–≤–µ—Å—Ç–∏ –∑–º—ñ–Ω–Ω—É –Ω–∞ –µ–∫—Ä–∞–Ω"
        ],
        "correct_order": "1-2-3",
        "title": "üñã –£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –∫—Ä–æ–∫–∏ –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑–º—ñ–Ω–Ω–æ—ó:"
    },
    {
        "steps": [
            "–í—ñ–¥–∫—Ä–∏—Ç–∏ —Ñ–∞–π–ª —É —Ä–µ–∂–∏–º—ñ —á–∏—Ç–∞–Ω–Ω—è (open)",
            "–ó—á–∏—Ç–∞—Ç–∏ –¥–∞–Ω—ñ –∑ —Ñ–∞–π–ª—É (read)",
            "–ó–∞–∫—Ä–∏—Ç–∏ —Ñ–∞–π–ª (close)"
        ],
        "correct_order": "1-2-3",
        "title": "üìÇ –£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –∫—Ä–æ–∫–∏ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è —Ñ–∞–π–ª—É –≤ Python:"
    },
    {
        "steps": [
            "–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é –∑ def",
            "–í–∏–∑–Ω–∞—á–∏—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü—ñ—ó",
            "–í–∏–∫–ª–∏–∫–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é"
        ],
        "correct_order": "1-2-3",
        "title": "‚öôÔ∏è –£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –∫—Ä–æ–∫–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ –≤–∏–∫–ª–∏–∫—É —Ñ—É–Ω–∫—Ü—ñ—ó –≤ Python:"
    },
    {
        "steps": [
            "–°—Ç–≤–æ—Ä–∏—Ç–∏ —Å–ø–∏—Å–æ–∫",
            "–î–æ–¥–∞—Ç–∏ –µ–ª–µ–º–µ–Ω—Ç –¥–æ —Å–ø–∏—Å–∫—É (append)",
            "–í–∏–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –Ω–∞ –µ–∫—Ä–∞–Ω"
        ],
        "correct_order": "1-2-3",
        "title": "üóÇ –£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –∫—Ä–æ–∫–∏ —Ä–æ–±–æ—Ç–∏ –∑—ñ —Å–ø–∏—Å–∫–æ–º –≤ Python:"
    },
    {
        "steps": [
            "–ù–∞–ø–∏—Å–∞—Ç–∏ —Ü–∏–∫–ª for",
            "–í–∏–∫–æ–Ω–∞—Ç–∏ —Ç—ñ–ª–æ —Ü–∏–∫–ª—É",
            "–ó–∞–≤–µ—Ä—à–∏—Ç–∏ —Ü–∏–∫–ª"
        ],
        "correct_order": "1-2-3",
        "title": "üîÑ –£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –∫—Ä–æ–∫–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ü–∏–∫–ª—É for –≤ Python:"
    },
    {
        "steps": [
            "–û–≥–æ–ª–æ—Å–∏—Ç–∏ –∫–ª–∞—Å",
            "–°—Ç–≤–æ—Ä–∏—Ç–∏ –º–µ—Ç–æ–¥ __init__",
            "–°—Ç–≤–æ—Ä–∏—Ç–∏ –µ–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—É"
        ],
        "correct_order": "1-2-3",
        "title": "üèó –£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –∫—Ä–æ–∫–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–ª–∞—Å—É –≤ Python:"
    },
    {
        "steps": [
            "–ù–∞–ø–∏—Å–∞—Ç–∏ —É–º–æ–≤—É if",
            "–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —É–º–æ–≤—É",
            "–í–∏–∫–æ–Ω–∞—Ç–∏ —Ç—ñ–ª–æ if"
        ],
        "correct_order": "1-2-3",
        "title": "üßê –£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –∫—Ä–æ–∫–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —É–º–æ–≤–Ω–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ if:"
    },
    {
        "steps": [
            "–Ü–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –±—ñ–±–ª—ñ–æ—Ç–µ–∫—É (import requests)",
            "–í–∏–∫–æ–Ω–∞—Ç–∏ HTTP –∑–∞–ø–∏—Ç (requests.get)",
            "–û–ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å"
        ],
        "correct_order": "1-2-3",
        "title": "üåê –£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –∫—Ä–æ–∫–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è HTTP-–∑–∞–ø–∏—Ç—É –≤ Python:"
    }
],
"Java": [
    {
        "steps": [
            "–ù–∞–ø–∏—Å–∞—Ç–∏ –∫–æ–¥ –∫–ª–∞—Å—É –∑ –º–µ—Ç–æ–¥–æ–º main",
            "–°–∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏ —Ñ–∞–π–ª –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é javac",
            "–ó–∞–ø—É—Å—Ç–∏—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º—É –∫–æ–º–∞–Ω–¥–æ—é java"
        ],
        "correct_order": "1-2-3",
        "title": "‚òïÔ∏è –£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –∫—Ä–æ–∫–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è Java-–ø—Ä–æ–≥—Ä–∞–º–∏:"
    },
    {
        "steps": [
            "–û–≥–æ–ª–æ—Å–∏—Ç–∏ –∫–ª–∞—Å",
            "–û–≥–æ–ª–æ—Å–∏—Ç–∏ –∑–º—ñ–Ω–Ω—ñ –∫–ª–∞—Å—É",
            "–°—Ç–≤–æ—Ä–∏—Ç–∏ –º–µ—Ç–æ–¥–∏ –∫–ª–∞—Å—É"
        ],
        "correct_order": "1-2-3",
        "title": "üì¶ –£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –∫—Ä–æ–∫–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–ª–∞—Å—É –≤ Java:"
    },
    {
        "steps": [
            "–Ü–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –ø–∞–∫–µ—Ç (import java.util.*)",
            "–û–≥–æ–ª–æ—Å–∏—Ç–∏ –∫–ª–∞—Å",
            "–°—Ç–≤–æ—Ä–∏—Ç–∏ –æ–±'—î–∫—Ç –∫–ª–∞—Å—É"
        ],
        "correct_order": "1-2-3",
        "title": "üìö –£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –∫—Ä–æ–∫–∏ —ñ–º–ø–æ—Ä—Ç—É —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∫–ª–∞—Å—É –≤ Java:"
    },
    {
        "steps": [
            "–û–≥–æ–ª–æ—Å–∏—Ç–∏ –º–∞—Å–∏–≤",
            "–Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –º–∞—Å–∏–≤ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏",
            "–í–∏–≤–µ—Å—Ç–∏ –º–∞—Å–∏–≤ –Ω–∞ –µ–∫—Ä–∞–Ω"
        ],
        "correct_order": "1-2-3",
        "title": "üóÇ –£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –∫—Ä–æ–∫–∏ —Ä–æ–±–æ—Ç–∏ –∑ –º–∞—Å–∏–≤–∞–º–∏ –≤ Java:"
    },
    {
        "steps": [
            "–û–≥–æ–ª–æ—Å–∏—Ç–∏ –∑–º—ñ–Ω–Ω—É —Ç–∏–ø—É int",
            "–ü—Ä–∏—Å–≤–æ—ó—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–º—ñ–Ω–Ω—ñ–π",
            "–í–∏–≤–µ—Å—Ç–∏ –∑–º—ñ–Ω–Ω—É –Ω–∞ –µ–∫—Ä–∞–Ω"
        ],
        "correct_order": "1-2-3",
        "title": "üî¢ –£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –∫—Ä–æ–∫–∏ —Ä–æ–±–æ—Ç–∏ –∑—ñ –∑–º—ñ–Ω–Ω–æ—é –≤ Java:"
    },
    {
        "steps": [
            "–ù–∞–ø–∏—Å–∞—Ç–∏ –º–µ—Ç–æ–¥",
            "–í–∏–∑–Ω–∞—á–∏—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –º–µ—Ç–æ–¥—É",
            "–í–∏–∫–ª–∏–∫–∞—Ç–∏ –º–µ—Ç–æ–¥ —É –ø—Ä–æ–≥—Ä–∞–º—ñ"
        ],
        "correct_order": "1-2-3",
        "title": "‚öôÔ∏è –£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –∫—Ä–æ–∫–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —ñ –≤–∏–∫–ª–∏–∫—É –º–µ—Ç–æ–¥—É –≤ Java:"
    },
    {
        "steps": [
            "–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ü–∏–∫–ª for",
            "–í–∏–∫–æ–Ω–∞—Ç–∏ —Ç—ñ–ª–æ —Ü–∏–∫–ª—É",
            "–ó–∞–≤–µ—Ä—à–∏—Ç–∏ —Ü–∏–∫–ª"
        ],
        "correct_order": "1-2-3",
        "title": "üîÑ –£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –∫—Ä–æ–∫–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ü–∏–∫–ª—É for —É Java:"
    },
    {
        "steps": [
            "–û–≥–æ–ª–æ—Å–∏—Ç–∏ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å",
            "–û–≥–æ–ª–æ—Å–∏—Ç–∏ –º–µ—Ç–æ–¥–∏ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É",
            "–†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É –∫–ª–∞—Å—ñ"
        ],
        "correct_order": "1-2-3",
        "title": "üõ†Ô∏è –£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –∫—Ä–æ–∫–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —ñ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É –≤ Java:"
    },
    {
        "steps": [
            "–û–≥–æ–ª–æ—Å–∏—Ç–∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∫–ª–∞—Å—É",
            "–Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –ø–æ–ª—è –∫–ª–∞—Å—É",
            "–°—Ç–≤–æ—Ä–∏—Ç–∏ –æ–±'—î–∫—Ç –∫–ª–∞—Å—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞"
        ],
        "correct_order": "1-2-3",
        "title": "üèóÔ∏è –£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –∫—Ä–æ–∫–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ –≤ Java:"
    },
    {
        "steps": [
            "–ü—ñ–¥–∫–ª—é—á–∏—Ç–∏ –±—ñ–±–ª—ñ–æ—Ç–µ–∫—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥ java.sql.*)",
            "–°—Ç–≤–æ—Ä–∏—Ç–∏ –∑'—î–¥–Ω–∞–Ω–Ω—è –∑ –±–∞–∑–æ—é –¥–∞–Ω–∏—Ö",
            "–í–∏–∫–æ–Ω–∞—Ç–∏ SQL-–∑–∞–ø–∏—Ç"
        ],
        "correct_order": "1-2-3",
        "title": "üõ¢Ô∏è –£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –∫—Ä–æ–∫–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö —É Java:"
    }
]
}


# –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó —Ç–µ–∫—Å—Ç—É –∑–∞–≤–¥–∞–Ω–Ω—è –∑ —Ä–∞–Ω–¥–æ–º—ñ–∑–∞—Ü—ñ—î—é
def generate_ordering_task(raw_task):
    steps = raw_task["steps"]
    indices = list(range(len(steps)))
    random.shuffle(indices)

    shuffled_steps = [f"{i+1}Ô∏è‚É£ {steps[idx]}" for i, idx in enumerate(indices)]
    correct_order = "-".join(str(indices.index(i)+1) for i in range(len(steps)))

    text = raw_task["title"] + "\n\n" + "\n".join(shuffled_steps) + "\n\n‚úèÔ∏è –í–≤–µ–¥—ñ—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –ø–æ—Ä—è–¥–æ–∫ —É —Ñ–æ—Ä–º–∞—Ç—ñ 1-2-3 (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: 1-3-2)"

    return text, correct_order


# –ì–µ–Ω–µ—Ä—É—î–º–æ ORDERING_TASKS –∑ –≥–æ—Ç–æ–≤–∏–º–∏ —Ç–µ–∫—Å—Ç–∞–º–∏ —ñ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–º–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—è–º–∏
ORDERING_TASKS = {}

for language, tasks in RAW_ORDERING_TASKS.items():
    ORDERING_TASKS[language] = []
    for task in tasks:
        question_text, correct_order = generate_ordering_task(task)
        ORDERING_TASKS[language].append({
            "question": question_text,
            "correct_order": correct_order
        })

async def start_ordering_task(update, context, language):
    tasks = ORDERING_TASKS.get(language)
    if tasks:
        task = random.choice(tasks)
        context.user_data["ordering_answer"] = task["correct_order"]
        await update.message.reply_text(task["question"])
    else:
        await update.message.reply_text("‚ö†Ô∏è –ó–∞–≤–¥–∞–Ω–Ω—è –¥–ª—è —Ü—ñ—î—ó –º–æ–≤–∏ —â–µ –Ω–µ –¥–æ–¥–∞–Ω–æ.")

async def handle_ordering_answer(update, context):
    user_id = update.effective_user.id
    user_input = update.message.text.strip()
    correct_answer = context.user_data.get("ordering_answer")

    
async def handle_ordering_answer(update, context):
    user_id = update.effective_user.id
    user_input = update.message.text.strip()
    correct_answer = context.user_data.get("ordering_answer")

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—ñ –≤–≤–æ–¥—É
    expected_set = set(correct_answer.split('-'))
    user_set = set(user_input.split('-'))

    if user_set != expected_set:
        await update.message.reply_text("‚ö†Ô∏è –ù–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–π –≤–≤—ñ–¥. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —á–∏—Å–ª–∞ —É —Ñ–æ—Ä–º–∞—Ç—ñ 1-2-3 –±–µ–∑ –ø—Ä–æ–ø—É—Å–∫—ñ–≤.")
        return
    if user_input == correct_answer:
        await update.message.reply_text("‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ! –ß—É–¥–æ–≤–∞ —Ä–æ–±–æ—Ç–∞! üéâ")
    else:
        await update.message.reply_text(f"‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ.\n–ü—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å: {correct_answer}")
    
    await update.message.reply_text("‚¨áÔ∏è –©–æ –¥–∞–ª—ñ?", reply_markup=get_ordering_task_menu())